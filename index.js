let map;

const field1Coords = [
  {lng:-68.30713723662271,lat:-16.61215143660221},
  {lng:-68.30718378431455,lat:-16.61165445557834},
  {lng:-68.30743977569743,lat:-16.61166563162798},
  {lng:-68.30746844458733,lat:-16.6118382428307},
  {lng:-68.30781269918141,lat:-16.61224539125423},
  {lng:-68.30761566381682,lat:-16.61228993163055},
  {lng:-68.30758990606817,lat:-16.61263390995526},
  {lng:-68.30707742778519,lat:-16.61253988330853},
  {lng:-68.30713723662271,lat:-16.61215143660221},
]
const field2Coords = [
  {lng: -68.29606140200958, lat: -16.63906206324029},
  {lng: -68.296162958548, lat: -16.63899994616124},
  {lng: -68.29631413120524, lat: -16.63898755969713},
  {lng: -68.29642134107834, lat: -16.63899240665302},
  {lng: -68.29642646793214, lat: -16.63959704419573},
  {lng: -68.29628085841335, lat: -16.63959563755056},
  {lng: -68.29626201624097, lat: -16.6395528304666},
  {lng: -68.29618943637368, lat: -16.63938796619414},
  {lng: -68.29606193153808, lat: -16.63906341189075},
  {lng: -68.29606144846177, lat: -16.63906218090862},
  {lng: -68.29606140200958, lat: -16.63906206324029},
];
const field3Coords = [
  {lng: -68.29889778251849, lat: -16.63809566411349},
  {lng: -68.29898795809756, lat: -16.63750371392828},
  {lng: -68.29903062061946, lat: -16.63750871211285},
  {lng: -68.2991698172477, lat: -16.63752764943854},
  {lng: -68.29926273006302, lat: -16.63754474007269},
  {lng: -68.2991736782632, lat: -16.63810116071974},
  {lng: -68.29889778251849, lat: -16.63809566411349},
]
const field4Coords = [
  {lng: -68.27259157603025, lat: -16.60720716276474},
  {lng: -68.27271155673982, lat: -16.60693731709002},
  {lng: -68.27343730530154, lat: -16.60720293392881},
  {lng: -68.27321981081866, lat: -16.60777404380589},
  {lng: -68.27298367963647, lat: -16.60768325020866},
  {lng: -68.27249520669669, lat: -16.60747040191145},
  {lng: -68.27259157603025, lat: -16.60720716276474},
]
const field5Coords = [
  {lng: -68.2998301313097, lat: -16.60958089776337},
  {lng: -68.29985157279904, lat: -16.60952107542887},
  {lng: -68.3001853696823, lat: -16.6095899039783},
  {lng: -68.30042337485074, lat: -16.60962227042321},
  {lng: -68.30064415532139, lat: -16.6097642979654},
  {lng: -68.30071495159893, lat: -16.60988948671852},
  {lng: -68.30064111731416, lat: -16.60996910074837},
  {lng: -68.30031193356655, lat: -16.60986101257244},
  {lng: -68.30021756372473, lat: -16.61003244204319},
  {lng: -68.30006591035229, lat: -16.60994574150218},
  {lng: -68.30010508965695, lat: -16.60991761649949},
  {lng: -68.30016775200716, lat: -16.60987477769844},
  {lng: -68.30020061818679, lat: -16.60984044852484},
  {lng: -68.30022458084819, lat: -16.60979891395778},
  {lng: -68.30021740508012, lat: -16.60972570472661},
  {lng: -68.30018786876853, lat: -16.60966246561785},
  {lng: -68.30014777917052, lat: -16.60963650078266},
  {lng: -68.30009576282326, lat: -16.60961623575325},
  {lng: -68.30004367466198, lat: -16.60961606036536},
  {lng: -68.29997594098079, lat: -16.60959873620543},
  {lng: -68.29994702653319, lat: -16.6095913404821},
  {lng: -68.29988902084857, lat: -16.60958109972732},
  {lng: -68.29988891022617, lat: -16.60958109935474},
  {lng: -68.2998301313097, lat: -16.60958089776337},
]

const field6Coords = [
  {lng: -68.28603934561872, lat: -16.61117099719814},
  {lng: -68.28619116838594, lat: -16.61084990037013},
  {lng: -68.2862434554292, lat: -16.61087191887204},
  {lng: -68.28623450709853, lat: -16.61089094298778},
  {lng: -68.28665518202682, lat: -16.61106285929324},
  {lng: -68.28663154467476, lat: -16.6111246521787},
  {lng: -68.28682611450051, lat: -16.61120534478935},
  {lng: -68.28667054735057, lat: -16.61154543889473},
  {lng: -68.28640375144403, lat: -16.61145742944345},
  {lng: -68.286441790106, lat: -16.61133944350901},
  {lng: -68.28603934561872, lat: -16.61117099719814},
];

const field7Coords = [
  {lng: -68.27766381789269, lat: -16.60931581609156},
  {lng: -68.27781694056112, lat: -16.60890347868136},
  {lng: -68.27788716082041, lat: -16.60893282912454},
  {lng: -68.27814163800157, lat: -16.60902133077049},
  {lng: -68.27810016566771, lat: -16.6091237193915},
  {lng: -68.2785276155164, lat: -16.60929334317504},
  {lng: -68.27840302906208, lat: -16.60966353960856},
  {lng: -68.27820923709679, lat: -16.60957932569836},
  {lng: -68.27766381789269, lat: -16.60931581609156},
];

const field8Coords = [
  {lng: -68.27774481102098, lat: -16.60648496540598},
  {lng: -68.27776214879736, lat: -16.60642369405861},
  {lng: -68.27748100871239, lat: -16.60634149921412},
  {lng: -68.27762640777516, lat: -16.60596588866811},
  {lng: -68.27854937945057, lat: -16.60624052525396},
  {lng: -68.27859558764364, lat: -16.60625802295333},
  {lng: -68.27846140788562, lat: -16.60671502677589},
  {lng: -68.27774481102098, lat: -16.60648496540598,},
]

const field9Coords = [
  {lng: -68.2784406493888, lat: -16.60689660830455},
  {lng: -68.27849821185116, lat: -16.60672789990228},
  {lng: -68.27937102237792, lat: -16.60703322808751},
  {lng: -68.27934771984644, lat: -16.6071530987101},
  {lng: -68.27924527907513, lat: -16.60734747703329},
  {lng: -68.27839173105914, lat: -16.60704000955897},
  {lng: -68.2784406493888, lat: -16.60689660830455},
];

const field10Coords = [
  {lng: -68.27744147706137, lat: -16.60831720554761},
  {lng: -68.27756769076207, lat: -16.60805865053482},
  {lng: -68.2777667399826, lat: -16.60812033927158},
  {lng: -68.27826870030655, lat: -16.60828688686685},
  {lng: -68.2780801086751, lat: -16.60864047269251},
  {lng: -68.27741857225706, lat: -16.60839050686686},
  {lng: -68.27744147706137, lat: -16.60831720554761,},
];

const field11Coords = [
  {lng: -68.30696766656305, lat: -16.61782888111798},
  {lng: -68.30833947348323, lat: -16.61779935577107},
  {lng: -68.30834014451064, lat: -16.61792614364194},
  {lng: -68.30823283852223, lat: -16.61791721712797},
  {lng: -68.30818381798245, lat: -16.61809699984371},
  {lng: -68.30839317164181, lat: -16.61811456419096},
  {lng: -68.30834451583328, lat: -16.61893867152807},
  {lng: -68.30831900724604, lat: -16.61893555843394},
  {lng: -68.30831350370394, lat: -16.61903247787206},
  {lng: -68.30653162911428, lat: -16.61913488347657},
  {lng: -68.30525258310368, lat: -16.61928142249429},
  {lng: -68.30482347140479, lat: -16.61932854637789},
  {lng: -68.30477127786703, lat: -16.61932200352931},
  {lng: -68.30474884717184, lat: -16.61931109574534},
  {lng: -68.30474343910826, lat: -16.61925285356317},
  {lng: -68.30474782782316, lat: -16.619204121894},
  {lng: -68.30473266686519, lat: -16.61912418072187},
  {lng: -68.30469212506779, lat: -16.61907259051253},
  {lng: -68.30463895820886, lat: -16.61901689577065},
  {lng: -68.30459833357799, lat: -16.61898832480594},
  {lng: -68.30455767877135, lat: -16.61896787737182},
  {lng: -68.30452121376283, lat: -16.61895421531141},
  {lng: -68.30447493251185, lat: -16.61893645720867},
  {lng: -68.30436275217104, lat: -16.61888868938035},
  {lng: -68.30428154208001, lat: -16.61882071474663},
  {lng: -68.30422427437135, lat: -16.61873386209119},
  {lng: -68.30416701646651, lat: -16.61864430217685},
  {lng: -68.30412497781934, lat: -16.618618434569},
  {lng: -68.30408265787811, lat: -16.61859986526343},
  {lng: -68.30418816909499, lat: -16.61841294918934},
  {lng: -68.30418864667544, lat: -16.61841206403117},
  {lng: -68.30418941189035, lat: -16.61841045036293},
  {lng: -68.30418957830416, lat: -16.61841005951757},
  {lng: -68.30430007400162, lat: -16.6181438002374},
  {lng: -68.30585299445616, lat: -16.61792668091009},
  {lng: -68.30696766656305, lat: -16.61782888111798},
];

const field12Coords = [
  {lng: -68.30673777556481, lat: -16.62073307331269},
  {lng: -68.30757624557552, lat: -16.62059570582981},
  {lng: -68.307608153476, lat: -16.62080137548816},
  {lng: -68.30674378647676, lat: -16.62088159139455},
  {lng: -68.30673777556481, lat: -16.62073307331269},
];

const field13Coords = [
  {lng: -68.32280159955438, lat: -16.61687056306379},
  {lng: -68.32338479554846, lat: -16.61681255005642},
  {lng: -68.32348651460352, lat: -16.61681334225724},
  {lng: -68.32349521561402, lat: -16.61688005390345},
  {lng: -68.32351119868545, lat: -16.61700371007176},
  {lng: -68.32283463405075, lat: -16.61707228445928},
  {lng: -68.32282866794658, lat: -16.61703581834374},
  {lng: -68.32280159955438, lat: -16.61687056306379},
];

const field14Coords = [
  {lng: -68.32375796999082, lat: -16.61801744529421},
  {lng: -68.32420378616979, lat: -16.6179504949828},
  {lng: -68.32426637386706, lat: -16.618157437619},
  {lng: -68.32377586963416, lat: -16.61824446364685},
  {lng: -68.32370467234735, lat: -16.61803049639831},
  {lng: -68.32375796999082, lat: -16.61801744529421},
];

const field15Coords = [
  {lng: -68.30387506355112, lat: -16.61823463206135},
  {lng: -68.30405541559506, lat: -16.61816205387359},
  {lng: -68.30408582538347, lat: -16.61811625404861},
  {lng: -68.3040949980174, lat: -16.61815169179701},
  {lng: -68.30422768498069, lat: -16.61815742416561},
  {lng: -68.30423442155458, lat: -16.61815600947162},
  {lng: -68.30413715810246, lat: -16.6183923422529},
  {lng: -68.30408691896638, lat: -16.61847887012941},
  {lng: -68.30388140455658, lat: -16.61832476630777},
  {lng: -68.30387506355112, lat: -16.61823463206135},
];

const field16Coords = [
  {lng: -68.28076079417369, lat: -16.61166444969304},
  {lng: -68.28055181031539, lat: -16.61160074968807},
  {lng: -68.28075433555492, lat: -16.61112021688781},
  {lng: -68.28090684027445, lat: -16.61118929220186},
  {lng: -68.28090694042019, lat: -16.61118933684085},
  {lng: -68.28121183560984, lat: -16.61132603232635},
  {lng: -68.28121283714263, lat: -16.61132645882865},
  {lng: -68.28121371151067, lat: -16.61132679540219},
  {lng: -68.28138478327804, lat: -16.61138941815828},
  {lng: -68.28119451310235, lat: -16.61179666726585},
  {lng: -68.28076079417369, lat: -16.61166444969304},
];

const field17Coords = [
  {lng: -68.30409393818076, lat: -16.61931493148232},
  {lng: -68.30409512226197, lat: -16.61929282255609},
  {lng: -68.30409872096092, lat: -16.61922583154249},
  {lng: -68.30409870487887, lat: -16.61922274907995},
  {lng: -68.30409853030052, lat: -16.61922098221176},
  {lng: -68.30409839204322, lat: -16.6192200633536},
  {lng: -68.30409227092129, lat: -16.6191838801409},
  {lng: -68.30408485545804, lat: -16.6191400417107},
  {lng: -68.30408470095351, lat: -16.61913920867166},
  {lng: -68.30408428904467, lat: -16.61913747897366},
  {lng: -68.30408376077197, lat: -16.61913577961959},
  {lng: -68.30408311799093, lat: -16.61913411603925},
  {lng: -68.3040823644191, lat: -16.61913249728443},
  {lng: -68.30408150284622, lat: -16.61913092969198},
  {lng: -68.30408102841113, lat: -16.61913016066444},
  {lng: -68.30403291197638, lat: -16.61905502193413},
  {lng: -68.30403241962772, lat: -16.61905428086838},
  {lng: -68.30403135323547, lat: -16.61905283462048},
  {lng: -68.30403124123737, lat: -16.61905269413584},
  {lng: -68.30397324183939, lat: -16.61898027837601},
  {lng: -68.30394716771883, lat: -16.61892105216772},
  {lng: -68.3039608328429, lat: -16.6188535208823},
  {lng: -68.30399570458901, lat: -16.61877075164051},
  {lng: -68.3040198115682, lat: -16.61877929591164},
  {lng: -68.30404161755891, lat: -16.61882408376903},
  {lng: -68.30406601750545, lat: -16.61882651933873},
  {lng: -68.30410982549117, lat: -16.61886196643131},
  {lng: -68.30415363442732, lat: -16.61889741442218},
  {lng: -68.30419732375178, lat: -16.61896580852459},
  {lng: -68.30424846233576, lat: -16.61899892720351},
  {lng: -68.30429472865936, lat: -16.61902967662017},
  {lng: -68.30438491233856, lat: -16.61906527894053},
  {lng: -68.30445393493297, lat: -16.61909072430638},
  {lng: -68.30447510546308, lat: -16.61909852831877},
  {lng: -68.30452628650107, lat: -16.61911988058789},
  {lng: -68.30455789087216, lat: -16.61915528673953},
  {lng: -68.30456212141938, lat: -16.61917184466805},
  {lng: -68.30457955391675, lat: -16.61924008120318},
  {lng: -68.30457205295333, lat: -16.61928947768722},
  {lng: -68.30455722142361, lat: -16.6193412052807},
  {lng: -68.30409393818076, lat: -16.61931493148232},
];

function drawInMap(map, coords) {
  const fieldArea = new google.maps.Polygon({
    paths: coords,
    strokeColor: '#FF0000',
    fillColor: '#FF0000',
    strokeOpacity: 0.6,
    strokeWeight: 1,
  });
  fieldArea.setMap(map)
}

function getCurrentLocation() {
  return new Promise((res) => {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        res({
          lat: position.coords.latitude,
          lng: position.coords.longitude,
        });
      });
    } else {
      alert('Error, no se puede acceder a su localización');
    }
  })
}

async function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: {lng: -68.30713723662271,lat:-16.61215143660221},
    zoom: 14,
  });
  drawInMap(map, field1Coords)
  drawInMap(map, field2Coords)
  drawInMap(map, field3Coords)
  drawInMap(map, field4Coords)
  drawInMap(map, field5Coords)
  drawInMap(map, field6Coords)
  drawInMap(map, field7Coords)
  drawInMap(map, field8Coords)
  drawInMap(map, field9Coords)
  drawInMap(map, field10Coords)
  drawInMap(map, field11Coords)
  drawInMap(map, field12Coords)
  drawInMap(map, field13Coords)
  drawInMap(map, field14Coords)
  drawInMap(map, field15Coords)
  drawInMap(map, field16Coords)
  drawInMap(map, field17Coords)

}
let marker
async function actualLocation() {
  let locs = await getCurrentLocation();
  const locationCoords = new google.maps.LatLng(locs.lat, locs.lng)

  marker = new google.maps.Marker({
    position: locationCoords,
  })
  marker.setMap(map);
}

window.onload = function() {
  initMap();
  actualLocation();
  setInterval(() => {
    console.log('Actualizando: ', marker)
    if (marker) {marker.setMap(null)}
    actualLocation();
  }, 5000);
}